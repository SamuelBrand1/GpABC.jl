<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ABC Advanced · GpABC</title><link rel="canonical" href="https://tanhevg.github.io/GpABC.jl/stable/ref-abc-advanced/index.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>GpABC</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><span class="toctext">Package Overview</span><ul><li><a class="toctext" href="../overview-abc/">ABC Parameter Inference</a></li><li><a class="toctext" href="../overview-ms/">ABC Model Selection</a></li><li><a class="toctext" href="../overview-lna/">LNA</a></li><li><a class="toctext" href="../overview-gp/">Gaussian Process Regression</a></li><li><a class="toctext" href="../summary_stats/">Summary Statistics</a></li></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../example-abc/">ABC Parameter Inference</a></li><li><a class="toctext" href="../example-ms/">ABC Model Selection</a></li><li><a class="toctext" href="../example-lna/">Stochastic inference (LNA)</a></li><li><a class="toctext" href="../example-gp/">Gaussian Processes</a></li></ul></li><li><span class="toctext">Reference</span><ul><li><a class="toctext" href="../ref-abc/">ABC Basic</a></li><li class="current"><a class="toctext" href>ABC Advanced</a><ul class="internal"><li><a class="toctext" href="#Index-1">Index</a></li><li><a class="toctext" href="#Types-and-Functions-1">Types and Functions</a></li></ul></li><li><a class="toctext" href="../ref-lna/">Stochastic inference (LNA)</a></li><li><a class="toctext" href="../ref-ms/">Model Selection</a></li><li><a class="toctext" href="../ref-gp/">Gaussian Processes</a></li><li><a class="toctext" href="../ref-kernels/">Kernels</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Reference</li><li><a href>ABC Advanced</a></li></ul><a class="edit-page" href="https://github.com/tanhevg/GpABC.jl/blob/master/docs/src/ref-abc-advanced.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>ABC Advanced</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="ABC-Advanced-Reference-1" href="#ABC-Advanced-Reference-1">ABC Advanced Reference</a></h1><p>Advanced aspects of <code>GpABC</code> support for parameter estimation with Approximate Bayesian Computation.</p><h2><a class="nav-anchor" id="Index-1" href="#Index-1">Index</a></h2><ul><li><a href="#GpABC.AbstractEmulatedParticleSelection"><code>GpABC.AbstractEmulatedParticleSelection</code></a></li><li><a href="#GpABC.AbstractEmulatorRetraining"><code>GpABC.AbstractEmulatorRetraining</code></a></li><li><a href="#GpABC.AbstractEmulatorTraining"><code>GpABC.AbstractEmulatorTraining</code></a></li><li><a href="#GpABC.DefaultEmulatorTraining"><code>GpABC.DefaultEmulatorTraining</code></a></li><li><a href="#GpABC.IncrementalRetraining"><code>GpABC.IncrementalRetraining</code></a></li><li><a href="#GpABC.MeanEmulatedParticleSelection"><code>GpABC.MeanEmulatedParticleSelection</code></a></li><li><a href="#GpABC.MeanVarEmulatedParticleSelection"><code>GpABC.MeanVarEmulatedParticleSelection</code></a></li><li><a href="#GpABC.NoopRetraining"><code>GpABC.NoopRetraining</code></a></li><li><a href="#GpABC.PreviousPopulationRetraining"><code>GpABC.PreviousPopulationRetraining</code></a></li><li><a href="#GpABC.PreviousPopulationThresholdRetraining"><code>GpABC.PreviousPopulationThresholdRetraining</code></a></li><li><a href="#GpABC.abc_retrain_emulator"><code>GpABC.abc_retrain_emulator</code></a></li><li><a href="#GpABC.abc_select_emulated_particles"><code>GpABC.abc_select_emulated_particles</code></a></li><li><a href="#GpABC.train_emulator"><code>GpABC.train_emulator</code></a></li></ul><h2><a class="nav-anchor" id="Types-and-Functions-1" href="#Types-and-Functions-1">Types and Functions</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.AbstractEmulatorTraining" href="#GpABC.AbstractEmulatorTraining"><code>GpABC.AbstractEmulatorTraining</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">AbstractEmulatorTraining</code></pre><p>Subtypes of this abstract type control how the emulator is trained for emulation-based ABC algorithms (rejection and SMC). At the moment, only <a href="#GpABC.DefaultEmulatorTraining"><code>DefaultEmulatorTraining</code></a> is shipped. Custom emulator training procedure can be implemented by creating new subtypes of this type and overriding <a href="#GpABC.train_emulator"><code>train_emulator</code></a> for them.</p><p>A typical use case would be trying to control the behaviour of <a href="../ref-gp/#GpABC.gp_train-Union{Tuple{GPModel}, Tuple{TOpt}} where TOpt&lt;:Optim.AbstractOptimizer"><code>gp_train</code></a> more tightly, or not using it altogeather (e.g. using another optimisation package).</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/abc/io.jl#L75-L84">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.DefaultEmulatorTraining" href="#GpABC.DefaultEmulatorTraining"><code>GpABC.DefaultEmulatorTraining</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">DefaultEmulatorTraining &lt;: AbstractEmulatorTraining</code></pre><p><strong>Fields</strong></p><ul><li><code>kernel::AbstractGPKernel</code>: the kernel (<a href="../ref-kernels/#GpABC.AbstractGPKernel"><code>AbstractGPKernel</code></a>) that will be used with the Gaussian Process (<a href="../ref-gp/#GpABC.GPModel"><code>GPModel</code></a>). Defaults to <a href="../ref-kernels/#GpABC.SquaredExponentialArdKernel"><code>SquaredExponentialArdKernel</code></a>.</li></ul><p><a href="#GpABC.train_emulator"><code>train_emulator</code></a> method with this argument type calls <a href="../ref-gp/#GpABC.gp_train-Union{Tuple{GPModel}, Tuple{TOpt}} where TOpt&lt;:Optim.AbstractOptimizer"><code>gp_train</code></a> with default arguments.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/abc/io.jl#L87-L94">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.AbstractEmulatedParticleSelection" href="#GpABC.AbstractEmulatedParticleSelection"><code>GpABC.AbstractEmulatedParticleSelection</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">AbstractEmulatedParticleSelection</code></pre><p>Subtypes of this type control the criteria that determine what particles are included in the posterior for emulation-based ABC. Custom strategies can be implemented by creating new subtypes of this type and overriding <a href="#GpABC.abc_select_emulated_particles"><code>abc_select_emulated_particles</code></a> for them.</p><p>Two implementations are shipped:</p><ul><li><a href="#GpABC.MeanEmulatedParticleSelection"><code>MeanEmulatedParticleSelection</code></a></li><li><a href="#GpABC.MeanVarEmulatedParticleSelection"><code>MeanVarEmulatedParticleSelection</code></a></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/abc/io.jl#L112-L121">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.MeanVarEmulatedParticleSelection" href="#GpABC.MeanVarEmulatedParticleSelection"><code>GpABC.MeanVarEmulatedParticleSelection</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>MeanVarEmulatedParticleSelection &lt;: AbstractEmulatedParticleSelection</p><p>When this strategy is used, the particles for which both <em>mean and standard deviation</em> returned by <a href="../ref-gp/#GpABC.gp_regression-Tuple{GPModel}"><code>gp_regression</code></a> is below the ABC threshold are included in the posterior.</p><p><strong>Fields</strong></p><ul><li><code>variance_threshold_factor</code>: scaling factor, by which the ABC threshold is multiplied</li></ul><p>before checking the standard deviation. Defaults to 1.0.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/abc/io.jl#L133-L142">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.MeanEmulatedParticleSelection" href="#GpABC.MeanEmulatedParticleSelection"><code>GpABC.MeanEmulatedParticleSelection</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>MeanEmulatedParticleSelection &lt;: AbstractEmulatedParticleSelection</p><p>When this strategy is used, the particles for which only the <em>mean</em> value returned by <a href="../ref-gp/#GpABC.gp_regression-Tuple{GPModel}"><code>gp_regression</code></a> is below the ABC threshold are included in the posterior. Variance is not checked.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/abc/io.jl#L124-L130">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.AbstractEmulatorRetraining" href="#GpABC.AbstractEmulatorRetraining"><code>GpABC.AbstractEmulatorRetraining</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">AbstractEmulatorRetraining</code></pre><p>Subtypes of this abstract type control the additional retraining procedure that may or may not be carried out before each iteration of emulation-based ABC. Custom strategies may be implemented by creating new subtypes of this type and new <a href="#GpABC.abc_retrain_emulator"><code>abc_retrain_emulator</code></a> methods for them.</p><p>The following implementations are shipped:</p><ul><li><a href="#GpABC.IncrementalRetraining"><code>IncrementalRetraining</code></a></li><li><a href="#GpABC.PreviousPopulationRetraining"><code>PreviousPopulationRetraining</code></a></li><li><a href="#GpABC.PreviousPopulationThresholdRetraining"><code>PreviousPopulationThresholdRetraining</code></a></li><li><a href="#GpABC.NoopRetraining"><code>NoopRetraining</code></a></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/abc/io.jl#L18-L28">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.IncrementalRetraining" href="#GpABC.IncrementalRetraining"><code>GpABC.IncrementalRetraining</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">IncrementalRetraining &lt;: AbstractEmulatorRetraining</code></pre><p>This emulator retraining strategy samples extra particles from the previous population, and adds them to the set of design points that were used on the previous iteration. The new design points are filtered according to the threshold. The combined set of design points is used to train the new emulator.</p><p><strong>Fields</strong></p><ul><li><code>design_points</code>: number of design points to add on each iteration</li><li><code>max_simulations</code>: maximum number of simulations to perform during re-trainging on each iteration</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/abc/io.jl#L31-L39">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.PreviousPopulationRetraining" href="#GpABC.PreviousPopulationRetraining"><code>GpABC.PreviousPopulationRetraining</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">PreviousPopulationRetraining &lt;: AbstractEmulatorRetraining</code></pre><p>This emulator retraining strategy samples extra particles from the previous population, and uses them to re-train the emulator from scratch. No filtering of the new design points is performed. Design points from the previous iteration are discarded.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/abc/io.jl#L45-L49">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.PreviousPopulationThresholdRetraining" href="#GpABC.PreviousPopulationThresholdRetraining"><code>GpABC.PreviousPopulationThresholdRetraining</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">PreviousPopulationThresholdRetraining &lt;: AbstractEmulatorRetraining</code></pre><p>This emulator retraining strategy samples extra particles from the previous population, and uses them to re-train the emulator from scratch. Design points from the previous iteration are discarded. This strategy allows to control how many design points are sampled with distance to the reference data below the threshold.</p><p><strong>Fields:</strong></p><ul><li><code>n_design_points</code>: number of design points</li><li><code>n_below_threshold</code>: number of design points below the threshold</li><li><code>max_iter</code>: maximum number of simulations to perform on each re-training iteration</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/abc/io.jl#L52-L61">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.NoopRetraining" href="#GpABC.NoopRetraining"><code>GpABC.NoopRetraining</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">NoopRetraining &lt;: AbstractEmulatorRetraining</code></pre><p>A sentinel retraining strategy that does not do anything. When used, the emulator is trained only once at the start of the process.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/abc/io.jl#L68-L72">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.train_emulator" href="#GpABC.train_emulator"><code>GpABC.train_emulator</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">train_emulator(training_x, training_y, emulator_training&lt;:AbstractEmulatorTraining)</code></pre><p>Train the emulator. For custom training procedure, a new subtype of <a href="#GpABC.AbstractEmulatorTraining"><code>AbstractEmulatorTraining</code></a> should be created, and a method of this function should be created for it.</p><p><strong>Returns</strong></p><p>A trained emulator. Shipped implementations return a <a href="../ref-gp/#GpABC.GPModel"><code>GPModel</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/util/emulation_helpers.jl#L146-L154">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.abc_retrain_emulator" href="#GpABC.abc_retrain_emulator"><code>GpABC.abc_retrain_emulator</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">abc_retrain_emulator(
    gp_model,
    particle_sampling_function,
    epsilon,
    training_input::EmulatorTrainingInput,
    retraining_settings&lt;:AbstractEmulatorRetraining
    )</code></pre><p>Additional retraining procedure for the emulator that may or may not be executed before every iteration of emulation based ABC. Details of the procedure are determined by the subtype of <a href="#GpABC.AbstractEmulatorRetraining"><code>AbstractEmulatorRetraining</code></a> that is passed as an argument.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/util/emulation_helpers.jl#L25-L35">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.abc_select_emulated_particles" href="#GpABC.abc_select_emulated_particles"><code>GpABC.abc_select_emulated_particles</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">abc_select_emulated_particles(emulator, particles, threshold, selection&lt;:AbstractEmulatedParticleSelection)</code></pre><p>Compute the approximate distances by running the regression-based <code>emulator</code> on the provided <code>particles</code>, and return the accepted particles. Acceptance strategy is determined by <code>selection</code> - subtype of <a href="#GpABC.AbstractEmulatedParticleSelection"><code>AbstractEmulatedParticleSelection</code></a>.</p><p><strong>Return</strong></p><p>A tuple of accepted distances, and indices of the accepted particles in the supplied <code>particles</code> array.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/43baca0508428142b39037a5e910abfecc55e42f/src/util/emulation_helpers.jl#L163-L170">source</a></section><footer><hr/><a class="previous" href="../ref-abc/"><span class="direction">Previous</span><span class="title">ABC Basic</span></a><a class="next" href="../ref-lna/"><span class="direction">Next</span><span class="title">Stochastic inference (LNA)</span></a></footer></article></body></html>
